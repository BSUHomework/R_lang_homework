"Fair number based on population:: ", Europe@data$population, "<br/>",
"Difference: ", Europe@data$difference,"%" ,
sep="") %>%
lapply(htmltools::HTML)
leaflet(Europe)%>%
#addTiles()
setView(10, 51, zoom = 3) %>%
addPolygons( fillColor = ~pal(difference),stroke=TRUE, fillOpacity = 0.9, color="#DDDDDD", weight=0.3,label = mytext,
labelOptions = labelOptions(
style = list("font-weight" = "normal", padding = "3px 8px"),
textsize = "13px",
direction = "auto"
))
pal = colorBin( palette = c("#B21021","#E05261","#FA9449","#FAAF49","#2DD303","#09B034"),domain =  Europe$difference,bins=mybins)
mytext <- paste(Europe$NAME,"<br/><br/>",
"Number of asylum seekers taken in 2019: ", Europe@data$applicants,"<br/>",
"Fair number based on population:: ", Europe@data$population, "<br/>",
"Difference: ", Europe@data$difference,"%" ,
sep="") %>%
lapply(htmltools::HTML)
leaflet(Europe)%>%
#addTiles()
setView(10, 51, zoom = 3) %>%
addPolygons( fillColor = ~pal(difference),stroke=TRUE, fillOpacity = 0.9, color="#DDDDDD", weight=0.3,label = mytext,
labelOptions = labelOptions(
style = list("font-weight" = "normal", padding = "3px 8px"),
textsize = "13px",
direction = "auto"
))
pal = colorBin( palette = c("#C10703","#ED5E31","#CA7E18","#EDE231","#E7ED31","#B7ED31"),domain =  Europe$difference,bins=mybins)
mytext <- paste(Europe$NAME,"<br/><br/>",
"Number of asylum seekers taken in 2019: ", Europe@data$applicants,"<br/>",
"Fair number based on population:: ", Europe@data$population, "<br/>",
"Difference: ", Europe@data$difference,"%" ,
sep="") %>%
lapply(htmltools::HTML)
leaflet(Europe)%>%
#addTiles()
setView(10, 51, zoom = 3) %>%
addPolygons( fillColor = ~pal(difference),stroke=TRUE, fillOpacity = 0.9, color="#DDDDDD", weight=0.3,label = mytext,
labelOptions = labelOptions(
style = list("font-weight" = "normal", padding = "3px 8px"),
textsize = "13px",
direction = "auto"
))
pal = colorBin( palette = c("#C10703","#ED5E31","#CA7E18","#89ED31","#64ED31","#11BB09"),domain =  Europe$difference,bins=mybins)
mytext <- paste(Europe$NAME,"<br/><br/>",
"Number of asylum seekers taken in 2019: ", Europe@data$applicants,"<br/>",
"Fair number based on population:: ", Europe@data$population, "<br/>",
"Difference: ", Europe@data$difference,"%" ,
sep="") %>%
lapply(htmltools::HTML)
leaflet(Europe)%>%
#addTiles()
setView(10, 51, zoom = 3) %>%
addPolygons( fillColor = ~pal(difference),stroke=TRUE, fillOpacity = 0.9, color="#DDDDDD", weight=0.3,label = mytext,
labelOptions = labelOptions(
style = list("font-weight" = "normal", padding = "3px 8px"),
textsize = "13px",
direction = "auto"
))
pal = colorBin( palette = c("#C10703","#ED5E31","#CA7E18","#BDFF8A","#64ED31","#11BB09"),domain =  Europe$difference,bins=mybins)
mytext <- paste(Europe$NAME,"<br/><br/>",
"Number of asylum seekers taken in 2019: ", Europe@data$applicants,"<br/>",
"Fair number based on population:: ", Europe@data$population, "<br/>",
"Difference: ", Europe@data$difference,"%" ,
sep="") %>%
lapply(htmltools::HTML)
leaflet(Europe)%>%
#addTiles()
setView(10, 51, zoom = 3) %>%
addPolygons( fillColor = ~pal(difference),stroke=TRUE, fillOpacity = 0.9, color="#DDDDDD", weight=0.3,label = mytext,
labelOptions = labelOptions(
style = list("font-weight" = "normal", padding = "3px 8px"),
textsize = "13px",
direction = "auto"
))
pal = colorBin( palette = c("#C10703","#ED5E31","#CA7E18","#BDFF8A","#6ED672","#11BB09"),domain =  Europe$difference,bins=mybins)
mytext <- paste(Europe$NAME,"<br/><br/>",
"Number of asylum seekers taken in 2019: ", Europe@data$applicants,"<br/>",
"Fair number based on population:: ", Europe@data$population, "<br/>",
"Difference: ", Europe@data$difference,"%" ,
sep="") %>%
lapply(htmltools::HTML)
leaflet(Europe)%>%
#addTiles()
setView(10, 51, zoom = 3) %>%
addPolygons( fillColor = ~pal(difference),stroke=TRUE, fillOpacity = 0.9, color="#DDDDDD", weight=0.3,label = mytext,
labelOptions = labelOptions(
style = list("font-weight" = "normal", padding = "3px 8px"),
textsize = "13px",
direction = "auto"
))
#used bins to plot Europe data
#pal <- colorNumeric(c("#B21021", "#0BD16E","#09B034"), Europe$population)
mybins <- c(NA,-Inf,-50,-25,0,25,50,Inf)
pal = colorBin( palette = c("#DDDDDD","#C10703","#ED5E31","#CA7E18","#BDFF8A","#6ED672","#11BB09"),domain =  Europe$difference,bins=mybins)
mytext <- paste(Europe$NAME,"<br/><br/>",
"Number of asylum seekers taken in 2019: ", Europe@data$applicants,"<br/>",
"Fair number based on population:: ", Europe@data$population, "<br/>",
"Difference: ", Europe@data$difference,"%" ,
sep="") %>%
lapply(htmltools::HTML)
leaflet(Europe)%>%
#addTiles()
setView(10, 51, zoom = 3) %>%
addPolygons( fillColor = ~pal(difference),stroke=TRUE, fillOpacity = 0.9, color="#DDDDDD", weight=0.3,label = mytext,
labelOptions = labelOptions(
style = list("font-weight" = "normal", padding = "3px 8px"),
textsize = "13px",
direction = "auto"
))
??colorBin
??RColorBrewer
pal = colorBin( palette = c("#C10703","#ED5E31","#CA7E18","#BDFF8A","#6ED672","#11BB09"),na.color = "#DDDDDD",domain =  Europe$difference,bins=mybins)
mytext <- paste(Europe$NAME,"<br/><br/>",
"Number of asylum seekers taken in 2019: ", Europe@data$applicants,"<br/>",
"Fair number based on population:: ", Europe@data$population, "<br/>",
"Difference: ", Europe@data$difference,"%" ,
sep="") %>%
lapply(htmltools::HTML)
leaflet(Europe)%>%
#addTiles()
setView(10, 51, zoom = 3) %>%
addPolygons( fillColor = ~pal(difference),stroke=TRUE, fillOpacity = 0.9, color="#DDDDDD", weight=0.3,label = mytext,
labelOptions = labelOptions(
style = list("font-weight" = "normal", padding = "3px 8px"),
textsize = "13px",
direction = "auto"
))
# Usual area chart
p <- data %>%
ggplot( aes(x=date, y=stimmberechtigt/100)) +
geom_area(fill="#02B7E6", alpha=0.5) +
geom_line(color="blue")  +
theme_ipsum()+
scale_x_date(breaks=date_breaks("10 years"),labels=date_format("%Y"),limits = as.Date(c("1870-01-01","2020-01-01")))+
scale_y_continuous(labels = percent,breaks = seq(0, 2, by = 0.1),limits = c(0,1) )+
annotate("segment", x = anydate("1968-01-01"), xend = anydate("1966-01-01"), y = 0.59, yend = 0.61,col="blue",size=0.5,arrow=arrow(length=unit(0.2,"cm")))+
annotate("text",x=anydate("1947-01-01") ,y=0.65,label="Rights to vote: \n women and people on welfare ")+
annotate("segment", x = anydate("1977-01-01"), xend = anydate("1977-01-01"), y = 0.51, yend = 0.55,col="blue",size=0.5,arrow=arrow(ends="both"))+
annotate("text",x=anydate("1997-01-01") ,y=0.52,label="Right to vote Swiss abroad ")+
annotate("segment", x = anydate("1991-01-01"), xend = anydate("1991-01-01"), y = 0.77, yend = 0.73,col="blue",size=0.5,arrow=arrow(ends="both"))+
annotate("text",x=anydate("1997-01-01") ,y=0.80,label="Right to vote 18 ")
# Turn it interactive with ggplotly
p <- ggplotly(p)
p
# Libraries
library(ggplot2)
library(dplyr)
library(plotly)
library(hrbrthemes)
library(anytime)
library(scales)
# Load dataset from github
data <- read.csv("./data-QWWky_format.csv", header=T)
data$Jahr2=paste(data$Jahr, "-01-01", sep="")
data$date <- as.Date(data$Jahr2,'%Y')
# Usual area chart
p <- data %>%
ggplot( aes(x=date, y=stimmberechtigt/100)) +
geom_area(fill="#02B7E6", alpha=0.5) +
geom_line(color="blue")  +
theme_ipsum()+
scale_x_date(breaks=date_breaks("10 years"),labels=date_format("%Y"),limits = as.Date(c("1870-01-01","2020-01-01")))+
scale_y_continuous(labels = percent,breaks = seq(0, 2, by = 0.1),limits = c(0,1) )+
annotate("segment", x = anydate("1968-01-01"), xend = anydate("1966-01-01"), y = 0.59, yend = 0.61,col="blue",size=0.5,arrow=arrow(length=unit(0.2,"cm")))+
annotate("text",x=anydate("1947-01-01") ,y=0.65,label="Rights to vote: \n women and people on welfare ")+
annotate("segment", x = anydate("1977-01-01"), xend = anydate("1977-01-01"), y = 0.51, yend = 0.55,col="blue",size=0.5,arrow=arrow(ends="both"))+
annotate("text",x=anydate("1997-01-01") ,y=0.52,label="Right to vote Swiss abroad ")+
annotate("segment", x = anydate("1991-01-01"), xend = anydate("1991-01-01"), y = 0.77, yend = 0.73,col="blue",size=0.5,arrow=arrow(ends="both"))+
annotate("text",x=anydate("1997-01-01") ,y=0.80,label="Right to vote 18 ")
# Turn it interactive with ggplotly
p <- ggplotly(p)
p
# Usual area chart
p <- data %>%
ggplot( aes(x=date, y=stimmberechtigt/100)) +
geom_area(fill="#02B7E6", alpha=0.5) +
geom_line(color="blue")  +
theme_ipsum()+
scale_x_date(breaks=date_breaks("10 years"),labels=date_format("%Y"),limits = as.Date(c("1870-01-01","2020-01-01")))+
scale_y_continuous(labels = percent,breaks = seq(0, 2, by = 0.1),limits = c(0,1) )+
annotate("segment", x = anydate("1968-01-01"), xend = anydate("1966-01-01"), y = 0.59, yend = 0.61,col="blue",size=0.5,arrow = arrow())+
annotate("text",x=anydate("1947-01-01") ,y=0.65,label="Rights to vote: \n women and people on welfare ")+
annotate("segment", x = anydate("1977-01-01"), xend = anydate("1977-01-01"), y = 0.51, yend = 0.55,col="blue",size=0.5,arrow=arrow(ends="both"))+
annotate("text",x=anydate("1997-01-01") ,y=0.52,label="Right to vote Swiss abroad ")+
annotate("segment", x = anydate("1991-01-01"), xend = anydate("1991-01-01"), y = 0.77, yend = 0.73,col="blue",size=0.5,arrow=arrow(ends="both"))+
annotate("text",x=anydate("1997-01-01") ,y=0.80,label="Right to vote 18 ")
# Turn it interactive with ggplotly
p <- ggplotly(p)
p
# Usual area chart
p <- data %>%
ggplot( aes(x=date, y=stimmberechtigt/100)) +
geom_area(fill="#02B7E6", alpha=0.5) +
geom_line(color="blue")  +
theme_ipsum()+
scale_x_date(breaks=date_breaks("10 years"),labels=date_format("%Y"),limits = as.Date(c("1870-01-01","2020-01-01")))+
scale_y_continuous(labels = percent,breaks = seq(0, 2, by = 0.1),limits = c(0,1) )+
annotate("segment", x = anydate("1968-01-01"), xend = anydate("1966-01-01"), y = 0.59, yend = 0.61,col="blue",size=0.5,arrow = arrow(length = unit(100,
"cm")))+
annotate("text",x=anydate("1947-01-01") ,y=0.65,label="Rights to vote: \n women and people on welfare ")+
annotate("segment", x = anydate("1977-01-01"), xend = anydate("1977-01-01"), y = 0.51, yend = 0.55,col="blue",size=0.5,arrow=arrow(ends="both"))+
annotate("text",x=anydate("1997-01-01") ,y=0.52,label="Right to vote Swiss abroad ")+
annotate("segment", x = anydate("1991-01-01"), xend = anydate("1991-01-01"), y = 0.77, yend = 0.73,col="blue",size=0.5,arrow=arrow(ends="both"))+
annotate("text",x=anydate("1997-01-01") ,y=0.80,label="Right to vote 18 ")
# Turn it interactive with ggplotly
p <- ggplotly(p)
p
# Usual area chart
p <- data %>%
ggplot( aes(x=date, y=stimmberechtigt/100)) +
geom_area(fill="#02B7E6", alpha=0.5) +
geom_line(color="blue")  +
theme_ipsum()+
scale_x_date(breaks=date_breaks("10 years"),labels=date_format("%Y"),limits = as.Date(c("1870-01-01","2020-01-01")))+
scale_y_continuous(labels = percent,breaks = seq(0, 2, by = 0.1),limits = c(0,1) )+
annotate("segment", x = anydate("1968-01-01"), xend = anydate("1966-01-01"), y = 0.59, yend = 0.61,col="blue",size=0.5,arrow = arrow(ends = "both", angle = 90, length = unit(0.2,
"cm")))+
annotate("text",x=anydate("1947-01-01") ,y=0.65,label="Rights to vote: \n women and people on welfare ")+
annotate("segment", x = anydate("1977-01-01"), xend = anydate("1977-01-01"), y = 0.51, yend = 0.55,col="blue",size=0.5,arrow=arrow(ends="both"))+
annotate("text",x=anydate("1997-01-01") ,y=0.52,label="Right to vote Swiss abroad ")+
annotate("segment", x = anydate("1991-01-01"), xend = anydate("1991-01-01"), y = 0.77, yend = 0.73,col="blue",size=0.5,arrow=arrow(ends="both"))+
annotate("text",x=anydate("1997-01-01") ,y=0.80,label="Right to vote 18 ")
# Turn it interactive with ggplotly
p <- ggplotly(p)
p
# Usual area chart
p <- data %>%
ggplot( aes(x=date, y=stimmberechtigt/100)) +
geom_area(fill="#02B7E6", alpha=0.5) +
geom_line(color="blue")  +
theme_ipsum()+
scale_x_date(breaks=date_breaks("10 years"),labels=date_format("%Y"),limits = as.Date(c("1870-01-01","2020-01-01")))+
scale_y_continuous(labels = percent,breaks = seq(0, 2, by = 0.1),limits = c(0,1) )+
annotate("segment", x = anydate("1968-01-01"), xend = anydate("1966-01-01"), y = 0.59, yend = 0.61,col="blue",size=0.5,arrow = arrow())+
annotate("text",x=anydate("1947-01-01") ,y=0.65,label="Rights to vote: \n women and people on welfare ")+
annotate("segment", x = anydate("1977-01-01"), xend = anydate("1977-01-01"), y = 0.51, yend = 0.55,col="blue",size=0.5,arrow=arrow(ends="both"))+
annotate("text",x=anydate("1997-01-01") ,y=0.52,label="Right to vote Swiss abroad ")+
annotate("segment", x = anydate("1991-01-01"), xend = anydate("1991-01-01"), y = 0.77, yend = 0.73,col="blue",size=0.5,arrow=arrow(ends="both"))+
annotate("text",x=anydate("1997-01-01") ,y=0.80,label="Right to vote 18 ")
# Turn it interactive with ggplotly
p <- ggplotly(p)
p
# Usual area chart
p <- data %>%
ggplot( aes(x=date, y=stimmberechtigt/100)) +
geom_area(fill="#02B7E6", alpha=0.5) +
geom_line(color="blue")  +
theme_ipsum()+
scale_x_date(breaks=date_breaks("10 years"),labels=date_format("%Y"),limits = as.Date(c("1870-01-01","2020-01-01")))+
scale_y_continuous(labels = percent,breaks = seq(0, 2, by = 0.1),limits = c(0,1) )+
annotate("segment", x = anydate("1968-01-01"), xend = anydate("1966-01-01"), y = 0.59, yend = 0.61,col="blue",size=0.5,arrow = arrow())+
annotate("text",x=anydate("1947-01-01") ,y=0.65,label="Rights to vote: \n women and people on welfare ")+
annotate("segment", x = anydate("1977-01-01"), xend = anydate("1977-01-01"), y = 0.51, yend = 0.55,col="blue",size=0.5,arrow=arrow())+
annotate("text",x=anydate("1997-01-01") ,y=0.52,label="Right to vote Swiss abroad ")+
annotate("segment", x = anydate("1991-01-01"), xend = anydate("1991-01-01"), y = 0.77, yend = 0.73,col="blue",size=0.5,arrow=arrow())+
annotate("text",x=anydate("1997-01-01") ,y=0.80,label="Right to vote 18 ")
# Turn it interactive with ggplotly
p <- ggplotly(p)
p
# Usual area chart
p <- data %>%
ggplot( aes(x=date, y=stimmberechtigt/100)) +
geom_area(fill="#02B7E6", alpha=0.5) +
geom_line(color="blue")  +
theme_ipsum()+
scale_x_date(breaks=date_breaks("10 years"),labels=date_format("%Y"),limits = as.Date(c("1870-01-01","2020-01-01")))+
scale_y_continuous(labels = percent,breaks = seq(0, 2, by = 0.1),limits = c(0,1) )+
geom_segment(aes( x = anydate("1968-01-01"), xend = anydate("1966-01-01"), y = 0.59, yend = 0.61),color="blue",size=0.5,arrow = arrow())+
annotate("text",x=anydate("1947-01-01") ,y=0.65,label="Rights to vote: \n women and people on welfare ")+
annotate("segment", x = anydate("1977-01-01"), xend = anydate("1977-01-01"), y = 0.51, yend = 0.55,col="blue",size=0.5,arrow=arrow())+
annotate("text",x=anydate("1997-01-01") ,y=0.52,label="Right to vote Swiss abroad ")+
annotate("segment", x = anydate("1991-01-01"), xend = anydate("1991-01-01"), y = 0.77, yend = 0.73,col="blue",size=0.5,arrow=arrow())+
annotate("text",x=anydate("1997-01-01") ,y=0.80,label="Right to vote 18 ")
# Turn it interactive with ggplotly
p <- ggplotly(p)
p
# Usual area chart
p <- data %>%
ggplot( aes(x=date, y=stimmberechtigt/100)) +
geom_area(fill="#02B7E6", alpha=0.5) +
geom_line(color="blue")  +
theme_ipsum()+
scale_x_date(breaks=date_breaks("10 years"),labels=date_format("%Y"),limits = as.Date(c("1870-01-01","2020-01-01")))+
scale_y_continuous(labels = percent,breaks = seq(0, 2, by = 0.1),limits = c(0,1) )+
geom_segment(aes( x = anydate("1968-01-01"), xend = anydate("1966-01-01"), y = 0.59, yend = 0.61),color="blue",size=0.5,arrow = arrow(length = unit(0.5, "cm")))+
annotate("text",x=anydate("1947-01-01") ,y=0.65,label="Rights to vote: \n women and people on welfare ")+
annotate("segment", x = anydate("1977-01-01"), xend = anydate("1977-01-01"), y = 0.51, yend = 0.55,col="blue",size=0.5,arrow=arrow())+
annotate("text",x=anydate("1997-01-01") ,y=0.52,label="Right to vote Swiss abroad ")+
annotate("segment", x = anydate("1991-01-01"), xend = anydate("1991-01-01"), y = 0.77, yend = 0.73,col="blue",size=0.5,arrow=arrow())+
annotate("text",x=anydate("1997-01-01") ,y=0.80,label="Right to vote 18 ")
# Turn it interactive with ggplotly
p <- ggplotly(p)
p
# Usual area chart
p <- data %>%
ggplot( aes(x=date, y=stimmberechtigt/100)) +
geom_area(fill="#02B7E6", alpha=0.5) +
geom_line(color="blue")  +
theme_ipsum()+
scale_x_date(breaks=date_breaks("10 years"),labels=date_format("%Y"),limits = as.Date(c("1870-01-01","2020-01-01")))+
scale_y_continuous(labels = percent,breaks = seq(0, 2, by = 0.1),limits = c(0,1) )+
geom_segment(aes( x = anydate("1968-01-01"), xend = anydate("1966-01-01"), y = 0.59, yend = 0.61),color="blue",size=0.5,arrow = arrow(length = unit(0.5, "cm")))+
annotate("text",x=anydate("1947-01-01") ,y=0.65,label="Rights to vote: \n women and people on welfare ")+
annotate("segment", x = anydate("1977-01-01"), xend = anydate("1977-01-01"), y = 0.51, yend = 0.55,col="blue",size=0.5,arrow=arrow())+
annotate("text",x=anydate("1997-01-01") ,y=0.52,label="Right to vote Swiss abroad ")+
annotate("segment", x = anydate("1991-01-01"), xend = anydate("1991-01-01"), y = 0.77, yend = 0.73,col="blue",size=0.5,arrow=arrow())+
annotate("text",x=anydate("1997-01-01") ,y=0.80,label="Right to vote 18 ")
p
# Turn it interactive with ggplotly
p <- ggplotly(p) %>%
layout(annotations=list(
list(
x=positiox_positiony$x_position[2],
y=positiox_positiony$y_position[2],
showarrow=TRUE,
xref = "x",
yref = "y",
arrowhead = 2,
arrowsize = 1.5,
ax=-20,
ay=20
)))
p
# Usual area chart
p <- data %>%
ggplot( aes(x=date, y=stimmberechtigt/100)) +
geom_area(fill="#02B7E6", alpha=0.5) +
geom_line(color="blue")  +
theme_ipsum()+
scale_x_date(breaks=date_breaks("10 years"),labels=date_format("%Y"),limits = as.Date(c("1870-01-01","2020-01-01")))+
scale_y_continuous(labels = percent,breaks = seq(0, 2, by = 0.1),limits = c(0,1) )+
annotate("segment", x = anydate("1968-01-01"), xend = anydate("1966-01-01"), y = 0.59, yend = 0.61,col="blue",size=0.5,arrow = arrow())+
annotate("text",x=anydate("1947-01-01") ,y=0.65,label="Rights to vote: \n women and people on welfare ")+
annotate("segment", x = anydate("1977-01-01"), xend = anydate("1977-01-01"), y = 0.51, yend = 0.55,col="blue",size=0.5,arrow=arrow())+
annotate("text",x=anydate("1997-01-01") ,y=0.52,label="Right to vote Swiss abroad ")+
annotate("segment", x = anydate("1991-01-01"), xend = anydate("1991-01-01"), y = 0.77, yend = 0.73,col="blue",size=0.5,arrow=arrow())+
annotate("text",x=anydate("1997-01-01") ,y=0.80,label="Right to vote 18 ")
# Turn it interactive with ggplotly
p <- ggplotly(p) %>%
layout(annotations=list(
list(
x=anydate("1968-01-01"),
y=0.59,
showarrow=TRUE,
xref = "x",
yref = "y",
arrowhead = 2,
arrowsize = 1.5,
ax=-20,
ay=20
)))
p
# Usual area chart
p <- data %>%
ggplot( aes(x=date, y=stimmberechtigt/100)) +
geom_area(fill="#02B7E6", alpha=0.5) +
geom_line(color="blue")  +
theme_ipsum()+
scale_x_date(breaks=date_breaks("10 years"),labels=date_format("%Y"),limits = as.Date(c("1870-01-01","2020-01-01")))+
scale_y_continuous(labels = percent,breaks = seq(0, 2, by = 0.1),limits = c(0,1) )+
#annotate("segment", x = anydate("1968-01-01"), xend = anydate("1966-01-01"), y = 0.59, yend = 0.61,col="blue",size=0.5,arrow = arrow())+
annotate("text",x=anydate("1947-01-01") ,y=0.65,label="Rights to vote: \n women and people on welfare ")+
#annotate("segment", x = anydate("1977-01-01"), xend = anydate("1977-01-01"), y = 0.51, yend = 0.55,col="blue",size=0.5,arrow=arrow())+
annotate("text",x=anydate("1997-01-01") ,y=0.52,label="Right to vote Swiss abroad ")+
#annotate("segment", x = anydate("1991-01-01"), xend = anydate("1991-01-01"), y = 0.77, yend = 0.73,col="blue",size=0.5,arrow=arrow())+
annotate("text",x=anydate("1997-01-01") ,y=0.80,label="Right to vote 18 ")
# Usual area chart
p <- data %>%
ggplot( aes(x=date, y=stimmberechtigt/100)) +
geom_area(fill="#02B7E6", alpha=0.5) +
geom_line(color="blue")  +
theme_ipsum()+
scale_x_date(breaks=date_breaks("10 years"),labels=date_format("%Y"),limits = as.Date(c("1870-01-01","2020-01-01")))+
scale_y_continuous(labels = percent,breaks = seq(0, 2, by = 0.1),limits = c(0,1) )+
#annotate("segment", x = anydate("1968-01-01"), xend = anydate("1966-01-01"), y = 0.59, yend = 0.61,col="blue",size=0.5,arrow = arrow())+
annotate("text",x=anydate("1947-01-01") ,y=0.65,label="Rights to vote: \n women and people on welfare ")+
#annotate("segment", x = anydate("1977-01-01"), xend = anydate("1977-01-01"), y = 0.51, yend = 0.55,col="blue",size=0.5,arrow=arrow())+
annotate("text",x=anydate("1997-01-01") ,y=0.52,label="Right to vote Swiss abroad ")+
#annotate("segment", x = anydate("1991-01-01"), xend = anydate("1991-01-01"), y = 0.77, yend = 0.73,col="blue",size=0.5,arrow=arrow())+
annotate("text",x=anydate("1997-01-01") ,y=0.80,label="Right to vote 18 ")
# Turn it interactive with ggplotly
p <- ggplotly(p) %>%
layout(annotations=list(
list(
x=anydate("1968-01-01"),
y=0.59,
showarrow=TRUE,
xref = "x",
yref = "y",
arrowhead = 2,
arrowsize = 1.5,
ax=-20,
ay=20
)))
p
# Usual area chart
p <- data %>%
ggplot( aes(x=date, y=stimmberechtigt/100)) +
geom_area(fill="#02B7E6", alpha=0.5) +
geom_line(color="blue")  +
theme_ipsum()+
scale_x_date(breaks=date_breaks("10 years"),labels=date_format("%Y"),limits = as.Date(c("1870-01-01","2020-01-01")))+
scale_y_continuous(labels = percent,breaks = seq(0, 2, by = 0.1),limits = c(0,1) )+
annotate("segment", x = anydate("1968-01-01"), xend = anydate("1966-01-01"), y = 0.59, yend = 0.61,col="blue",size=0.5,arrow = arrow())+
annotate("text",x=anydate("1947-01-01") ,y=0.65,label="Rights to vote: \n women and people on welfare ")+
annotate("segment", x = anydate("1977-01-01"), xend = anydate("1977-01-01"), y = 0.51, yend = 0.55,col="blue",size=0.5,arrow=arrow())+
annotate("text",x=anydate("1997-01-01") ,y=0.52,label="Right to vote Swiss abroad ")+
annotate("segment", x = anydate("1991-01-01"), xend = anydate("1991-01-01"), y = 0.77, yend = 0.73,col="blue",size=0.5,arrow=arrow())+
annotate("text",x=anydate("1997-01-01") ,y=0.80,label="Right to vote 18 ")
# Turn it interactive with ggplotly
p <- ggplotly(p)
p
setwd("~/Desktop/Homework/R_lang_homework/Rlang_study")
data1 = read.csv("https://github.com/BSUHomework/R_lang_homework/blob/main/Rlang_study/task3_heatmap_data_1.csv")
data2 = read.csv("https://github.com/BSUHomework/R_lang_homework/blob/main/Rlang_study/task3_heatmap_data2.csv")
par(adj = 0)
# Load dataset from github
data <- read.csv("https://github.com/BSUHomework/R_lang_homework/blob/main/Rlang_study/data-QWWky_format.csv", header=T)
data_jrstu= read.csv("https://github.com/BSUHomework/R_lang_homework/blob/main/Rlang_study/data-jrStu.csv",header = T)
library(rgdal)
library(dplyr)
library(RColorBrewer)
library(rworldmap)
library(leaflet)
#import data form Europe shap data
Europe <- readOGR( dsn= paste0(getwd(),"/Europe/") , layer="Europe",verbose=FALSE)
Europe@data$index = row.names(Europe@data)
Europe@data$index = as.integer(Europe@data$index)
data_jrstu= read.csv("https://github.com/BSUHomework/R_lang_homework/blob/main/Rlang_study/data-jrStu.csv",header = T)
#merge web message wiht Europe database
delindex = merge(Europe@data,data_jrstu,by.x="NAME",by.y="country.EN")$index
Europe@data = merge(Europe@data,data_jrstu,by.x="NAME",by.y="country.EN",all.x=T)
Europe@data = Europe@data[order(sort(Europe@data$index)),]
Europe@data = Europe@data[order(Europe@data$index),]
Europe@polygons= Europe@polygons[1:50]
mybins <- c(-Inf,-50,-25,0,25,50,Inf)
pal = colorBin( palette = c("#C10703","#ED5E31","#CA7E18","#BDFF8A","#6ED672","#11BB09"),na.color = "#DDDDDD",domain =  Europe$difference,bins=mybins)
mytext <- paste(Europe$NAME,"<br/><br/>",
"Number of asylum seekers taken in 2019: ", Europe@data$applicants,"<br/>",
"Fair number based on population:: ", Europe@data$population, "<br/>",
"Difference: ", Europe@data$difference,"%" ,
sep="") %>%
lapply(htmltools::HTML)
leaflet(Europe)%>%
setView(10, 51, zoom = 3) %>%
addPolygons( fillColor = ~pal(difference),stroke=TRUE, fillOpacity = 0.9, color="#DDDDDD", weight=0.3,label = mytext,
labelOptions = labelOptions(
style = list("font-weight" = "normal", padding = "3px 8px"),
textsize = "13px",
direction = "auto"
))
#merge web message wiht Europe database
delindex = merge(Europe@data,data_jrstu,by.x="NAME",by.y="country.EN")$index
data_jrstu= read.csv("https://github.com/BSUHomework/R_lang_homework/blob/main/Rlang_study/data-jrStu.csv",header = T)
View(data_jrstu)
x <- getURL("https://github.com/BSUHomework/R_lang_homework/blob/main/Rlang_study/data-jrStu.csv")
data_jrstu <- read.csv(text = x,header = T)
library(RCurl)
x <- getURL("https://github.com/BSUHomework/R_lang_homework/blob/main/Rlang_study/data-jrStu.csv")
data_jrstu <- read.csv(text = x,header = T)
View(data_jrstu)
View(data_jrstu)
View(data_jrstu)
data_jrstu= read.csv(rul("https://github.com/BSUHomework/R_lang_homework/blob/main/Rlang_study/data-jrStu.csv"),header = T)
data_jrstu= read.csv(url("https://github.com/BSUHomework/R_lang_homework/blob/main/Rlang_study/data-jrStu.csv"),header = T)
View(data_jrstu)
View(data_jrstu)
data_jrstu= read.csv(url("https://github.com/BSUHomework/R_lang_homework/blob/main/Rlang_study/data-jrStu.csv"),header = T)
data_jrstu= read.csv(url("https://github.com/BSUHomework/R_lang_homework/blob/main/Rlang_study/data-jrStu.csv"))
View(data_jrstu)
data_jrstu= read.table(url("https://github.com/BSUHomework/R_lang_homework/blob/main/Rlang_study/data-jrStu.csv"))
data_jrstu= read.table(url("https://github.com/BSUHomework/R_lang_homework/blob/main/Rlang_study/data-jrStu.csv"),sep = ",")
data_jrstu= read.table(url("https://github.com/BSUHomework/R_lang_homework/blob/main/Rlang_study/data-jrStu.csv"),sep = ",",header = T)
View(data_jrstu)
data_jrstu= read.csv(url("https://github.com/BSUHomework/R_lang_homework/blob/main/Rlang_study/data-jrStu.csv"),sep = ",",header = T)
data_jrstu= read.csv(url("https://github.com/BSUHomework/R_lang_homework/blob/main/Rlang_study/data-jrStu.csv"),sep = ",",header = T)
View(data_jrstu)
read.csv(url("https://github.com/BSUHomework/R_lang_homework/blob/main/Rlang_study/data-jrStu.csv"),sep = ",",header = T)
data_jrstu= read.csv(url("https://github.com/BSUHomework/R_lang_homework/blob/main/Rlang_study/data-jrStu.csv"),sep = ",",header = T)
View(data_jrstu)
data_jrstu= read.csv(url("https://github.com/BSUHomework/R_lang_homework/blob/main/Rlang_study/data-jrStu.csv"))
View(data_jrstu)
data_jrstu= read.csv(url('https://github.com/BSUHomework/R_lang_homework/blob/main/Rlang_study/data-jrStu.csv'),sep = ",",header = T)
View(data_jrstu)
data_jrstu= read.csv('data-jrStu.csv',sep = ",",header = T)
View(data_jrstu)
data1 = read.csv("https://github.com/BSUHomework/R_lang_homework/blob/main/Rlang_study/task3_heatmap_data_1.csv")
View(data1)
#install.packages("cowplot")
download.file("https://github.com/BSUHomework/R_lang_homework/blob/main/Rlang_study/task3_heatmap_data_1.csv")
#install.packages("cowplot")
download.file("https://github.com/BSUHomework/R_lang_homework/blob/main/Rlang_study/task3_heatmap_data_1.csv")
download.file("https://github.com/BSUHomework/R_lang_homework/blob/main/Rlang_study/task3_heatmap_data2.csv")
#install.packages("cowplot")
download.file("https://github.com/BSUHomework/R_lang_homework/blob/main/Rlang_study/task3_heatmap_data_1.csv",destfile = "./")
download.file("https://github.com/BSUHomework/R_lang_homework/blob/main/Rlang_study/task3_heatmap_data2.csv",destfile = "./")
data1 = read.csv("task3_heatmap_data_1.csv")
#install.packages("cowplot")
download.file("https://github.com/BSUHomework/R_lang_homework/blob/main/Rlang_study/task3_heatmap_data_1.csv",destfile = "./task3_heatmap_data_1.csv")
download.file("https://github.com/BSUHomework/R_lang_homework/blob/main/Rlang_study/task3_heatmap_data2.csv",destfile = "./task3_heatmap_data2.csv")
data1 = read.csv("task3_heatmap_data_1.csv")
View(data1)
data1 = read.csv("https://raw.githubusercontent.com/BSUHomework/R_lang_homework/main/Rlang_study/task3_heatmap_data_1.csv")
View(data1)
data2 = read.csv("https://raw.githubusercontent.com/BSUHomework/R_lang_homework/main/Rlang_study/task3_heatmap_data2.csv")
View(data2)
# Load dataset from github
data <- read.csv("https://raw.githubusercontent.com/BSUHomework/R_lang_homework/main/Rlang_study/data-QWWky_format.csv", header=T)
View(data_jrstu)
